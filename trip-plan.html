<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ‡¹ğŸ‡­ ×™×•××Ÿ ××¡×¢ ×™×¨×— ×“×‘×© â€“ ×ª××™×œ× ×“</title>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f172a;          /* slate-900 */
      --card:#111827;        /* gray-900 */
      --muted:#94a3b8;       /* slate-400 */
      --ring:#22d3ee;        /* cyan-400 */
      --brand:#38bdf8;       /* sky-400 */
      --ok:#10b981;          /* emerald-500 */
      --warn:#f59e0b;        /* amber-500 */
      --danger:#ef4444;      /* red-500 */
      --ink:#e5e7eb;         /* gray-200 */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Heebo, Arial, sans-serif; background:linear-gradient(135deg,#0b1023,#0f172a 25%,#0b2740 75%,#0b1023);
      color:var(--ink);
    }
    .container{max-width:1100px; margin:0 auto; padding:18px}
    header{
      position:sticky; top:0; z-index:10; backdrop-filter: blur(8px);
      background:rgba(11,16,35,.6); border-bottom:1px solid #1f2937;
    }
    header .inner{display:flex; gap:12px; align-items:center; justify-content:space-between; padding:12px 18px}
    .title{display:flex; align-items:center; gap:10px}
    .title h1{font-size:20px; margin:0}
    .title .tag{font-size:12px; color:var(--muted); border:1px solid #334155; padding:2px 8px; border-radius:999px}

    .controls{display:flex; flex-wrap:wrap; gap:8px; align-items:center}
    select, button, input[type="search"]{
      background:#0b2136; color:var(--ink); border:1px solid #1f3952; border-radius:10px; padding:8px 10px; font-family:inherit
    }
    button{cursor:pointer}
    button.primary{border-color:#2563eb; background:#0b1f3b}
    button.ghost{background:transparent}
    .chip{border:1px solid #1f3952; padding:6px 10px; border-radius:999px; cursor:pointer; user-select:none}
    .chip.active{border-color:var(--ring); box-shadow:0 0 0 2px rgba(34,211,238,.25) inset}

    .layout{display:grid; grid-template-columns: 280px 1fr; gap:16px; margin-top:16px}
    @media (max-width: 900px){ .layout{grid-template-columns:1fr} }

    .sidebar{background:rgba(17,24,39,.6); border:1px solid #1f2937; border-radius:16px; padding:14px}
    .sidebar h3{margin:0 0 8px 0; font-size:14px; color:var(--muted)}
    .days{display:grid; gap:6px; max-height:65vh; overflow:auto; padding-left:2px}
    .day-btn{display:flex; align-items:center; gap:8px; border:1px solid #1f3952; border-radius:12px; padding:8px 10px; background:#0b2136; cursor:pointer}
    .day-btn small{color:var(--muted)}
    .day-btn .progress{margin-inline-start:auto; font-size:12px; color:#a7f3d0}
    .day-btn.active{border-color:var(--ring); box-shadow:0 0 0 2px rgba(34,211,238,.25) inset}

    .card{background:rgba(17,24,39,.7); border:1px solid #1f2937; border-radius:18px; padding:18px}
    .card h2{margin:0 0 8px 0}
    .meta{display:flex; flex-wrap:wrap; gap:10px; color:var(--muted); font-size:14px}
    .badges{display:flex; gap:6px; flex-wrap:wrap}
    .badge{border:1px solid #334155; padding:4px 8px; border-radius:999px; font-size:12px; color:#cbd5e1}

    .todo{margin-top:14px; display:grid; gap:10px}
    .todo-item{display:flex; gap:10px; align-items:flex-start; background:#0b2136; border:1px solid #1f3952; border-radius:12px; padding:10px}
    .todo-item input{accent-color:var(--ok); margin-top:2px}

    .actions{display:flex; gap:8px; flex-wrap:wrap; margin-top:12px}

    .foot{display:flex; justify-content:space-between; align-items:center; margin-top:14px; color:var(--muted)}

    .kbd{border:1px solid #475569; padding:2px 6px; border-radius:6px; font-family:ui-monospace, Menlo, monospace; font-size:12px; color:#cbd5e1}

    .notice{margin-top:14px; background:#0b1f3b; border:1px dashed #334155; color:#cfe7ff; padding:12px; border-radius:12px}

    .divider{height:1px; background:#1f2937; margin:12px 0}

    .print{position:fixed; bottom:14px; left:14px; display:flex; gap:8px}
  </style>
</head>
<body>
  <header>
    <div class="inner container">
      <div class="title">
        <div style="font-size:22px">ğŸ‡¹ğŸ‡­</div>
        <h1>×™×•××Ÿ ××¡×¢ ×™×¨×— ×“×‘×© â€“ ×ª××™×œ× ×“</h1>
        <span class="tag">RTL â€¢ ×§×•×‘×¥ ××—×“ â€¢ ×©××™×¨×” ××§×•××™×ª</span>
      </div>
      <div class="controls">
        <input id="search" type="search" placeholder="×—×™×¤×•×© ×‘×™×•× ×”× ×•×›×—×™" />
        <button class="ghost" id="prev">×™×•× ×§×•×“×</button>
        <select id="jump"></select>
        <button class="ghost" id="next">×™×•× ×”×‘×</button>
        <button class="primary" id="toggleSection">×¡× ×Ÿ ×œ×¤×™ ××–×•×¨</button>
      </div>
    </div>
  </header>

  <main class="container layout">
    <aside class="sidebar" aria-label="×¨×©×™××ª ×™××™×">
      <h3>×”×™××™× ×‘××¡×œ×•×œ (27)</h3>
      <div class="days" id="days"></div>
      <div class="divider"></div>
      <h3>××–×•×¨×™×</h3>
      <div class="badges" id="zones">
        <!-- ×™××•×œ× ×“×™× ××™×ª -->
      </div>
    </aside>

    <section id="content">
      <article class="card" id="card">
        <!-- ×™××•×œ× ×“×™× ××™×ª -->
      </article>
      <div class="print">
        <button id="printBtn">×”×“×¤×¡/×™×™×¦× PDF</button>
        <button id="exportBtn">×™×™×¦×•× ×˜×•×“×• ×œ×§×•×‘×¥ .json</button>
        <button id="importBtn">×™×™×‘×•× ×˜×•×“×• ×-.json</button>
        <input id="importFile" type="file" accept="application/json" style="display:none" />
      </div>
    </section>
  </main>

  <script>
  // ===== × ×ª×•× ×™ ×”××¡×œ×•×œ =====
  const itinerary = [
    // ×‘× ×’×§×•×§ ×¤×ª×™×—×”
    {day:1, zone:'×‘× ×’×§×•×§', title:'×”××¨××” ××”××¨×¥ â†’ × ×—×™×ª×” ×‘×‘× ×’×§×•×§', location:'×‘× ×’×§×•×§ (×œ×™× ×ª ×”×ª××§×œ××•×ª)',
      todo:[
        '×¦×³×§-××™×Ÿ, ×‘×™×˜×—×•×Ÿ, ×§×¤×” ×§×˜×Ÿ ×œ×¤× ×™ ×”×”××¨××”',
        '× ×—×™×ª×”, ×“×¨×›×•× ×™×, ×¡×™×/××™×¡×™×, ×”×•×“×¢×ª â€œ× ×—×ª× ×•â€ ×œ××©×¤×—×”',
        'Grab ×œ××œ×•×Ÿ ×¢× ×‘×¨×™×›×”, ××§×œ×—×ª ×•×”×ª××•×©×©×•×ª',
        '×”×œ×™×›×” ×¨×›×” ×‘××–×•×¨, ×§× ×™×•×Ÿ/×©×•×§ ×œ×™×œ×”',
        '××¨×•×—×ª ×¢×¨×‘ ×ª××™×œ× ×“×™×ª ×¨××©×•× ×”, ×©×™× ×” ××•×§×“××ª'
      ]},
    // ×¦×³×™×× ×’ ×××™ + ×¤××™
    {day:2, zone:'×¦×¤×•×Ÿ', title:'×˜×™×¡×” ×œ×‘×¦×³×™×× ×’ ×××™', location:'×¦×³×™×× ×’ ×××™ (×¢×™×¨ ×¢×ª×™×§×”)',
      todo:[
        '××•× ×™×ª ×œ×©×“×” (BKK/DMK), ×˜×™×¡×” ~1:15 ×©×³',
        '×¦×³×§-××™×Ÿ ×‘××œ×•×Ÿ ×‘×¢×™×¨ ×”×¢×ª×™×§×”, ×§×¤×” ×§×¨',
        '××§×“×©×™× ×¨××©×•× ×™×: Wat Chedi Luang / Phra Singh',
        '×©×•×§ ×œ×™×œ×” ×¨×’×•×¢, ×¢×™×¡×•×™ ×¤×ª×™×—×”'
      ]},
    {day:3, zone:'×¦×¤×•×Ÿ', title:'×“×•×™ ×¡×•×˜×¤ ×•×ª×¦×¤×™×•×ª', location:'×¦×³×™×× ×’ ×××™',
      todo:[
        '× ×¡×™×¢×” ××•×§×“××ª ×œ-Doi Suthep â€“ ××•×¨ ×‘×•×§×¨ ×¨×š ×œ×¦×™×œ×•×',
        '×ª×¦×¤×™×ª ×œ×¢×™×¨, ×§×¤×” ××§×•××™',
        '× ×”×¨ ×¤×™× ×’ ×‘×¢×¨×‘, ××¡×¢×“×ª ×’×’ × ×¢×™××”'
      ]},
    {day:4, zone:'×¦×¤×•×Ÿ', title:'×©×™×¢×•×¨ ×‘×™×©×•×œ ×•×©×•×§', location:'×¦×³×™×× ×’ ×××™',
      todo:[
        '×©×™×¢×•×¨ ×‘×™×©×•×œ ×ª××™×œ× ×“×™ / Warorot Market',
        '×‘×ª×™ ×§×¤×” ××¢×•×¦×‘×™×, ××§×“×©×™× ×§×˜× ×™× ×‘×¢×™×¨ ×”×¢×ª×™×§×”',
        'Night Bazaar / Saturday Market (×× ×™×•×¦×)'
      ]},
    {day:5, zone:'×¦×¤×•×Ÿ', title:'××¢×‘×¨ ×œ×¤××™ â€“ ×§× ×™×•×Ÿ ×©×§×™×¢×”', location:'×¤××™ (1/3)',
      todo:[
        '××™× ×™×•×•××Ÿ ×œ×¤××™ ~3 ×©×³ (×¤×™×ª×•×œ×™× â€“ ×œ×¢×œ×•×ª ×§×œ×™×œ)',
        '×¦×³×§-××™×Ÿ ×œ×‘×•× ×’×œ×• ×™×¨×•×§',
        'Pai Canyon ×œ×©×§×™×¢×” â€“ ×¡×™×œ×•××˜×™× ×‘×ª××•× ×”'
      ]},
    {day:6, zone:'×¦×¤×•×Ÿ', title:'×¤××™ â€“ ××™× ×—××™× ×•××¤×œ×™×', location:'×¤××™ (2/3)',
      todo:[
        'Sai Ngam Hot Springs / Pam Bok Waterfall',
        '×’×©×¨ ×”×‘××‘×•×§ â€“ ××•×¨ ×¨×š ×œ×¦×™×œ×•××™×',
        '×©×•×§ ×œ×™×œ×” ××§×•××™, ××•×•×™×¨×ª ×¦×³×™×œ'
      ]},
    {day:7, zone:'×¦×¤×•×Ÿ', title:'×¤××™ ××™×˜×™×ª â€“ ×–×•×’×™×•×ª', location:'×¤××™ (3/3)',
      todo:[
        '×‘×•×§×¨ ×§×¤×” ××•×œ ×”×©×“×•×ª',
        '×¡×™×‘×•×‘ ×›×¤×¨×™ ×§×¦×¨ (×§×˜× ×•×¢/× ×”×’) â€“ ×§×œ×™×œ',
        '××¨×•×—×ª ×¢×¨×‘ ×—××™××” ×œ×¦×™×œ×•××™ ×¤×•×¨×˜×¨×˜'
      ]},
    {day:8, zone:'×¦×¤×•×Ÿ', title:'×—×–×¨×” ×œ×¦×³×™×× ×’ ×××™ â€“ ×œ×™× ×ª ××¢×‘×¨', location:'×¦×³×™×× ×’ ×××™ (××¢×‘×¨)',
      todo:[
        '×—×–×¨×” ×‘×¨×›×‘/××™× ×™×•×•××Ÿ ×œ×¦×³×™×× ×’ ×××™',
        '×›×‘×™×¡×” ×§×¦×¨×” ×•×× ×•×—×”',
        '×¡×™×“×•×¨ ×¦×™×•×“ ×œ×˜×™×¡×” ×“×¨×•××” ××—×¨'
      ]},

    // ××™×™× â€“ ×¡××•×™ ×§×¦×¨ ×•××– ×¤× ×’×Ÿ ××¨×•×š
    {day:9, zone:'××™×™×', title:'×˜×™×¡×” ×œ×§×• ×¡××•×™ â€“ ×©×§×™×¢×” ×¨××©×•× ×”', location:'×§×• ×¡××•×™ (1/3)',
      todo:[
        '×˜×™×¡×” ××¦×³×™×× ×’ ×××™ ×œ×¡××•×™ (×™×©×™×¨/×¢×¦×™×¨×” ×§×¦×¨×”)',
        '×¦×³×§-××™×Ÿ ×œ×¨×™×–×•×¨×˜ ×—×•×£ ×¨×’×•×¢',
        '×©×§×™×¢×” ×¨××©×•× ×”, ×’×•×¤×¨×• ×¢×œ ×”××™×'
      ]},
    {day:10, zone:'××™×™×', title:'×¡××•×™ â€“ ××¤×œ×™× ×•××§×“×©×™×', location:'×§×• ×¡××•×™ (2/3)',
      todo:[
        'Na Muang Waterfalls',
        'Big Buddha ×‘×©×¢×ª ×–×”×‘',
        '××¡×¢×“×ª ×—×•×£ × ×¢×™××”'
      ]},
    {day:11, zone:'××™×™×', title:'×¡××•×™ â€“ ×× ×’ ×ª×³×•× ×’ / ×¦×³×™×œ', location:'×§×• ×¡××•×™ (3/3)',
      todo:[
        '×©×™×˜/×¡× ×•×¨×§×œ ×œ××™×™ Ang Thong (×× ×”×™× ×¨×’×•×¢)',
        '××œ×˜×¨× ×˜×™×‘×”: ×™×•× ×¦×³×™×œ â€“ ×¡×¤×¨, ×™×, ×§×¤×”',
        '×©×§×™×¢×” ×¢×œ ×”×—×•×£'
      ]},

    {day:12, zone:'××™×™×', title:'××¢×‘×•×¨×ª ×œ×§×•×¤× ×’×Ÿ â€“ ×”×ª××§××•×ª', location:'×§×•×¤× ×’×Ÿ (1/6)',
      todo:[
        '××¢×‘×•×¨×ª ×§×¦×¨×” ××¡××•×™ ×œ×§×•×¤× ×’×Ÿ',
        '×¦×³×§-××™×Ÿ ×‘××¤×¨×¥ ×©×§×˜ ×‘×¦×“ ×”××¢×¨×‘×™',
        '× ×§×•×“×ª ×©×§×™×¢×”/×‘×¨ ×ª×¦×¤×™×ª ×¨××©×•×Ÿ'
      ]},
    {day:13, zone:'××™×™×', title:'×§×•×¤× ×’×Ÿ â€“ ×—×•×¤×™× ××¢×¨×‘×™×™×', location:'×§×•×¤× ×’×Ÿ (2/6)',
      todo:[
        'Haad Yao / Secret Beach â€“ ××™× ×¦×œ×•×œ×™×',
        '×§×¤×” ××•×œ ×”×™×',
        '×©×§×™×¢×” ×¨×•×× ×˜×™×ª'
      ]},
    {day:14, zone:'××™×™×', title:'×§×•×¤× ×’×Ÿ â€“ ×™×¢×¨×•×ª ×§×˜× ×™× ×•×§×¤×”', location:'×§×•×¤× ×’×Ÿ (3/6)',
      todo:[
        '×©×‘×™×œ ×™×¨×•×§ ×§×¦×¨ ×•× ×•×—',
        '×‘×ª×™ ×§×¤×” ×©×§×˜×™× ×œ×¦×™×œ×•× ×“×™×˜×œ×¡',
        '×©×•×§ ×œ×™×œ×” ×¦×‘×¢×•× ×™'
      ]},
    {day:15, zone:'××™×™×', title:'×§×•×¤× ×’×Ÿ â€“ ×™×•× ××™×', location:'×§×•×¤× ×’×Ÿ (4/6)',
      todo:[
        '×¡× ×•×¨×§×œ/×¦×œ×™×œ×” ×”×™×›×¨×•×ª (×§×œ×™×œ)',
        '×’×•×¤×¨×• ×ª×ª-×™××™',
        '××¨×•×—×ª ×“×’×™× ×¤×©×•×˜×”'
      ]},
    {day:16, zone:'××™×™×', title:'×§×•×¤× ×’×Ÿ â€“ ×™×•×’×”/×¡×“× ×”', location:'×§×•×¤× ×’×Ÿ (5/6)',
      todo:[
        '×¡×“× ×ª ×™×•×’×” ×‘×•×§×¨',
        '×–××Ÿ ×× ×•×—×” ×•×§×¨×™××”',
        '×©×§×™×¢×” ×‘-Amsterdam Bar (×× ××ª××™×)'
      ]},
    {day:17, zone:'××™×™×', title:'×§×•×¤× ×’×Ÿ â€“ ×™×•× ×—×•×¤×©×™', location:'×§×•×¤× ×’×Ÿ (6/6)',
      todo:[
        '×—×•×£ ××”×•×‘ ×—×•×–×¨×™× ××œ×™×•',
        '×‘×™×ª ×§×¤×” ××•×¢×“×£ ×•×—× ×•×ª ×§×˜× ×”',
        '××¨×™×–×ª ××¢×‘×¨ ×œ×™×•× ××—×¨'
      ]},

    // ×¨×™×™×œ×™/×§×¨××‘×™
    {day:18, zone:'×¨×™×™×œ×™/×§×¨××‘×™', title:'××¢×‘×¨ ×œ×™×‘×©×” â†’ ×¨×™×™×œ×™', location:'×¨×™×™×œ×™ (1/3)',
      todo:[
        '××¢×‘×•×¨×ª/××¢×‘×¨ ×œ×¡×•×¨×˜×³×× ×™/×“×•× ×¡××§ + ×¨×›×‘ ×œ-Ao Nang',
        'Longtail ×œ×¨×™×™×œ×™ ×•×¦×³×§-××™×Ÿ',
        '×¤×¨× × × ×’ ×œ×©×§×™×¢×” â€“ ××¢×¨×•×ª ×•×—×•×œ ×œ×‘×Ÿ'
      ]},
    {day:19, zone:'×¨×™×™×œ×™/×§×¨××‘×™', title:'×¨×™×™×œ×™ â€“ ×§×™××§ ×§×œ', location:'×¨×™×™×œ×™ (2/3)',
      todo:[
        '×§×™××§ ×œ××•×¨×š ×”×¦×•×§×™× (×¨×’×•×¢ ×•×‘×˜×•×—)',
        '×× ×•×—×” ×‘×—×•×£',
        '×˜×™×™×-×œ××¤×¡ ×©×§×™×¢×”'
      ]},
    {day:20, zone:'×¨×™×™×œ×™/×§×¨××‘×™', title:'×¡×™×•×¨ â€œ4 ××™×™×â€', location:'×¨×™×™×œ×™ (3/3)',
      todo:[
        '×©×™×˜ Longtail â€“ ×× ×”×™× × ×•×—',
        '×¡× ×•×¨×§×œ ×§×¦×¨ ×•×¦×™×œ×•× ×˜×•×¨×§×™×–',
        '××¨×•×—×ª ×“×’×™×, ×× ×•×—×”'
      ]},

    // ×‘× ×’×§×•×§ ×¡×™×•×
    {day:21, zone:'×‘× ×’×§×•×§', title:'×˜×™×¡×” ×œ×‘× ×’×§×•×§ â€“ ×”×ª××§××•×ª', location:'×‘× ×’×§×•×§ (1/4)',
      todo:[
        '×”×¢×‘×¨×” ×œ×©×“×” ×‘×§×¨×‘×™/×¤×•×§×˜, ×˜×™×¡×” ×§×¦×¨×” ×œ×‘× ×’×§×•×§',
        '×¦×³×§-××™×Ÿ ×‘××¨×›×– ×œ×™×“ BTS/MRT',
        '×©×™×˜ ×§×¦×¨ ×¢×œ ×”×¦×³××• ×¤×¨××™×” / ×¦×™×œ×•× ×œ×™×œ×” ××•×¨×‘× ×™'
      ]},
    {day:22, zone:'×‘× ×’×§×•×§', title:'×§×œ××¡×™×§×•×ª â€“ ××¨××•×Ÿ ×•-×•×•××˜ ×¤×•', location:'×‘× ×’×§×•×§ (2/4)',
      todo:[
        'Grand Palace ××•×§×“× (×¤×—×•×ª ×¢×•××¡, ××•×¨ ×˜×•×‘)',
        'Wat Pho ×•×”×‘×•×“×”× ×”×©×•×›×‘',
        '×¢×¨×‘ Rooftop â€“ ×¡×§×™×™×œ×™×™×Ÿ'
      ]},
    {day:23, zone:'×‘× ×’×§×•×§', title:'××•×“×¨× ×™ ×•×˜×¢×™×', location:'×‘× ×’×§×•×§ (3/4)',
      todo:[
        'ICONSIAM / ×‘×™×ª ×’×³×™× ×ª×•××¤×¡×•×Ÿ',
        'Chinatown â€“ × ×™××•× ×™× ×•××•×›×œ ×¨×—×•×‘',
        '××¡××–×³ ××—×¨×•×Ÿ'
      ]},
    {day:24, zone:'×‘× ×’×§×•×§', title:'×’×™×—×” ×§×œ×” â€“ ×”×™×¡×˜×•×¨×™×”/×©×•×•×§×™×', location:'×‘× ×’×§×•×§ (4/4)',
      todo:[
        '××™×•×ª××™×” / ×©×•×§ ×¦×£ ×œ×‘×—×™×¨×”',
        '×—×–×¨×” ×œ×©×§×™×¢×” ×¢×œ ×”× ×”×¨',
        '××¨×•×—×ª ×¡×™×›×•× ×–×•×’×™×ª'
      ]},
    {day:25, zone:'×‘× ×’×§×•×§', title:'×™×•× ×—×•×¤×©×™ â€“ ×§× ×™×•×ª ×•×’×™×‘×•×™×™×', location:'×‘× ×’×§×•×§ (×ª×•×¡×¤×ª ×’××™×©×”)',
      todo:[
        '×©×•×¤×™× ×’ ××ª× ×•×ª ××—×¨×•× ×•×ª',
        '×’×™×‘×•×™ ×ª××•× ×•×ª ×•-SD',
        '×¡×™×“×•×¨ ×ª×™×§×™× ×œ×˜×™×¡×”'
      ]},
    {day:26, zone:'×‘× ×’×§×•×§', title:'××—×¨×•×Ÿ ×¨×’×•×¢', location:'×‘× ×’×§×•×§',
      todo:[
        '×§×¤×” ××—×¨×•×Ÿ, ×”×œ×™×›×” ×§×œ×”',
        '×¢×•×“ × ×§×•×“×ª ×ª×¦×¤×™×ª ×× ×‘×',
        '×œ×™×©×•×Ÿ ××•×§×“× ×™×—×¡×™×ª'
      ]},
    {day:27, zone:'×˜×™×¡×” ×—×–×¨×”', title:'×—×–×¨×” ×œ×™×©×¨××œ', location:'× ×ª×‘×´×’',
      todo:[
        '×¦×³×§-×××•×˜ ××¡×•×“×¨ ×•× ×¡×™×¢×” ×œ×©×“×”',
        '×”××¨××” ××¨×¦×”',
        '×¤×™×ª×•×— ×¤×¨×¡×•× ×•×ª: ×× ×—× ×• ×—×•×–×¨×™× ×¢× ×¡×™×¤×•×¨×™×'
      ]},
  ];

  // ××–×•×¨×™× ×œ×ª×¦×•×’×ª ××¡× ×Ÿ
  const zonesOrder = ['×‘× ×’×§×•×§','×¦×¤×•×Ÿ','××™×™×','×¨×™×™×œ×™/×§×¨××‘×™','×˜×™×¡×” ×—×–×¨×”'];

  // ===== ×¢×–×¨×™ ××—×¡×•×Ÿ =====
  const keyFor = (day)=>`hm_th_itin_day_${day}`;

  function loadDayState(day){
    try{ return JSON.parse(localStorage.getItem(keyFor(day))) || {}; }
    catch{ return {}; }
  }
  function saveDayState(day, state){
    localStorage.setItem(keyFor(day), JSON.stringify(state));
    renderSidebar();
  }

  // ===== ×¨×™× ×“×•×¨ =====
  const daysEl = document.getElementById('days');
  const cardEl = document.getElementById('card');
  const jumpEl = document.getElementById('jump');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');
  const zonesEl = document.getElementById('zones');
  const searchEl = document.getElementById('search');

  let current = 1;
  let activeZoneFilter = null; // null = ×”×›×œ

  function renderJump(){
    jumpEl.innerHTML = itinerary.map(d=>`<option value="${d.day}">×™×•× ${d.day} â€¢ ${d.location}</option>`).join('');
    jumpEl.value = String(current);
  }

  function dayProgress(day){
    const d = itinerary.find(x=>x.day===day);
    const s = loadDayState(day);
    const done = (d.todo||[]).filter((_,i)=>s[i]).length;
    return {done, total:(d.todo||[]).length};
  }

  function renderSidebar(){
    const list = itinerary.filter(d=>!activeZoneFilter || d.zone===activeZoneFilter);
    daysEl.innerHTML = list.map(d=>{
      const {done,total} = dayProgress(d.day);
      const pct = total? Math.round(done/total*100):0;
      const active = d.day===current? 'active':'';
      return `<button class="day-btn ${active}" data-day="${d.day}">
        <div><strong>×™×•× ${d.day}</strong><br><small>${d.location}</small></div>
        <div class="progress">${done}/${total} â€¢ ${pct}%</div>
      </button>`;
    }).join('');
  }

  function renderZones(){
    zonesEl.innerHTML = zonesOrder.map(z=>{
      const active = z===activeZoneFilter ? 'active':'';
      return `<div class="chip ${active}" data-zone="${z}">${z}</div>`;
    }).join('');
  }

  function highlight(text, q){
    if(!q) return text;
    const esc = q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');
    return text.replace(new RegExp(esc,'gi'), m=>`<mark style="background:#a7f3d0;color:#0c4a6e;border-radius:4px;padding:0 2px">${m}</mark>`);
  }

  function renderDay(){
    const d = itinerary.find(x=>x.day===current);
    if(!d) return;
    const state = loadDayState(d.day);

    const list = (d.todo||[]).map((t,i)=>{
      const checked = state[i] ? 'checked' : '';
      const text = highlight(t, searchEl.value.trim());
      return `<label class="todo-item">
        <input type="checkbox" data-idx="${i}" ${checked} />
        <div>${text}</div>
      </label>`;
    }).join('');

    const {done,total} = dayProgress(d.day);

    cardEl.innerHTML = `
      <div class="meta">
        <div class="badge">××–×•×¨: ${d.zone}</div>
        <div class="badge">××™×§×•×: ${d.location}</div>
        <div class="badge">×”×ª×§×“××•×ª: ${done}/${total}</div>
      </div>
      <h2>×™×•× ${d.day} â€“ ${d.title}</h2>
      <div class="todo" id="todo">${list}</div>
      <div class="actions">
        <button id="markAll">×¡××Ÿ ×”×›×œ</button>
        <button id="clearAll">× ×§×” ×”×›×œ</button>
        <button id="copyDay">×”×¢×ª×§ ××ª ×”×™×•× ×œ×œ×•×—</button>
      </div>
      <div class="notice">
        ×˜×™×¤ ×¦×™×œ×•×: ×©××¨×• ×¢×œ ×’×™×‘×•×™ ×›×¤×•×œ â€“ ×˜×œ×¤×•×Ÿ + ×›×¨×˜×™×¡ SD × ×•×¡×£. ×©×§×™×¢×•×ª: ×¦×“ ××¢×¨×‘×™ ×©×œ ×”×—×•×¤×™×, ×‘×•×§×¨ ×¨×š ×œ××§×“×©×™×.
      </div>
    `;
  }

  // ===== ××™×¨×•×¢×™× =====
  function goTo(day){
    current = Math.max(1, Math.min(day, itinerary.length));
    renderJump();
    renderSidebar();
    renderDay();
  }

  document.addEventListener('click', (e)=>{
    const dayBtn = e.target.closest('.day-btn');
    if(dayBtn){ goTo(Number(dayBtn.dataset.day)); return; }

    const chip = e.target.closest('.chip');
    if(chip){
      const z = chip.dataset.zone;
      activeZoneFilter = (activeZoneFilter===z)? null : z;
      renderZones();
      renderSidebar();
      // ×× ×”×™×•× ×”× ×•×›×—×™ ×œ× ×‘××–×•×¨ â€“ ×§×¤×•×¥ ×œ×™×•× ×”×¨××©×•×Ÿ ×‘××¡× ×Ÿ
      const list = itinerary.filter(d=>!activeZoneFilter || d.zone===activeZoneFilter);
      if(!list.find(d=>d.day===current) && list.length){ goTo(list[0].day); }
      return;
    }

    if(e.target.id==='markAll'){
      const d = itinerary.find(x=>x.day===current);
      const state={}; (d.todo||[]).forEach((_,i)=>state[i]=true);
      saveDayState(current,state); renderDay(); return;
    }
    if(e.target.id==='clearAll'){
      saveDayState(current,{}); renderDay(); return;
    }
    if(e.target.id==='copyDay'){
      const d = itinerary.find(x=>x.day===current);
      const text = `×™×•× ${d.day} â€“ ${d.title}\n××™×§×•×: ${d.location}\n××©×™××•×ª:\n- ` + (d.todo||[]).join('\n- ');
      navigator.clipboard.writeText(text); 
      e.target.textContent='×”×•×¢×ª×§!'; setTimeout(()=>e.target.textContent='×”×¢×ª×§ ××ª ×”×™×•× ×œ×œ×•×—',1200);
      return;
    }
    if(e.target.id==='printBtn'){ window.print(); return; }
    if(e.target.id==='exportBtn'){
      const data={}; itinerary.forEach(d=>{ data[d.day]=loadDayState(d.day) });
      const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
      const a = document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='honeymoon_todos.json'; a.click();
      return;
    }
    if(e.target.id==='importBtn'){
      document.getElementById('importFile').click(); return;
    }
  });

  document.getElementById('importFile').addEventListener('change', (ev)=>{
    const f = ev.target.files[0]; if(!f) return;
    const r = new FileReader();
    r.onload = ()=>{
      try{
        const data = JSON.parse(r.result);
        Object.keys(data||{}).forEach(k=>{
          localStorage.setItem(keyFor(k), JSON.stringify(data[k]||{}));
        });
        renderSidebar(); renderDay();
      }catch(err){ alert('×§×•×‘×¥ ×œ× ×ª×§×™×Ÿ'); }
    };
    r.readAsText(f);
  });

  prevBtn.addEventListener('click', ()=> goTo(current-1));
  nextBtn.addEventListener('click', ()=> goTo(current+1));
  jumpEl.addEventListener('change', ()=> goTo(Number(jumpEl.value)));

  searchEl.addEventListener('input', ()=> renderDay());

  document.addEventListener('change', (e)=>{
    if(e.target.matches('.todo-item input[type="checkbox"]')){
      const idx = Number(e.target.dataset.idx);
      const st = loadDayState(current); st[idx]=e.target.checked; saveDayState(current, st);
      renderDay();
    }
  });

  document.getElementById('toggleSection').addEventListener('click', ()=>{
    // ×§×™×¦×•×¨ ×“×¨×š ×œ×¢×‘×•×¨ ×‘×™×Ÿ ×›×œ/×”××–×•×¨ ×©×œ ×”×™×•× ×”× ×•×›×—×™
    const z = itinerary.find(d=>d.day===current)?.zone;
    activeZoneFilter = (activeZoneFilter===z)? null : z;
    renderZones(); renderSidebar();
  });

  // ===== ×”×¤×¢×œ×” ×¨××©×•× ×™×ª =====
  function init(){
    renderZones();
    renderJump();
    renderSidebar();
    goTo(1);
  }
  init();
  </script>
</body>
</html>
